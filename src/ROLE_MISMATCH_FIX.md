# Исправление проблемы с ролями участников проекта

## Проблема
У участников с ролью "Участник с правами" (collaborator) не отображались задачи в проекте, несмотря на то что права были установлены корректно.

## Причина
Было несоответствие в названиях ролей между frontend и backend:

**Frontend** (`project-members-modal.tsx`):
- Использовал роль `'collaborator'` для "Участник с правами"

**Backend** (`/supabase/functions/server/index.tsx`):
- Проверял наличие роли `'admin'` для полного доступа к задачам
- Не распознавал роль `'collaborator'`

Когда пользователь получал роль `'collaborator'`, backend считал его обычным `'member'`, который видит только задачи, назначенные на него.

## Решение
Обновлены все permission helper функции в backend и frontend для поддержки роли `'collaborator'`:

### Backend (`/supabase/functions/server/index.tsx`)
Обновлены функции:
- `canViewAllProjectTasks()` - теперь проверяет `'admin' || 'collaborator'`
- `canEditTask()` - теперь проверяет `'admin' || 'collaborator'`
- `canCreateTask()` - теперь проверяет `'admin' || 'collaborator'`
- `canEditProject()` - теперь проверяет `'admin' || 'collaborator'`

### Frontend (`/contexts/app-context.tsx`)
1. Добавлена роль `'collaborator'` в тип `UserRole`
2. Обновлены все permission helper функции для проверки `'admin' || 'collaborator'`

## Система прав после исправления

**Владелец (owner)**:
- Полный доступ ко всем функциям
- Может удалять проект

**Участник с правами (collaborator/admin)**:
- Видит и редактирует все задачи проекта
- Может редактировать проект
- Может создавать задачи
- НЕ может удалить проект

**Участник (member)**:
- Видит только назначенные на него задачи
- Может редактировать только свои задачи
- Может создавать задачи
- НЕ может редактировать проект

**Наблюдатель (viewer)**:
- Видит все задачи
- НЕ может редактировать задачи
- НЕ может создавать задачи
- НЕ может редактировать проект

## Тестирование
1. Создайте проект как владелец
2. Пригласите пользователя с ролью "Участник с правами"
3. Создайте несколько задач в проекте
4. Войдите под приглашённым пользователем
5. Убедитесь, что все задачи отображаются в проекте
6. Проверьте возможность редактирования задач

## Дата исправления
03.11.2025
